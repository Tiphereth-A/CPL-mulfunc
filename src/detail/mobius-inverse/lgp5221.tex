\begin{frame}[fragile,allowframebreaks]{洛谷 P5221 Product}
	\label{mulf:example:lgp5221}

	\textbf{题目背景}

	CYJian: ``听说 \(\gcd\) 和 \(\sum\) 套起来比较好玩?? 那我就......''

	\textbf{题目描述}

	CYJian 最近闲的玩起了 \(\gcd\). 他想到了一个非常简单而有意思的式子:

	\[
		\prod_{i=1}^N\prod_{j=1}^N\frac{\lcm(i,j)}{\gcd(i,j)}\pmod{104857601}
	\]

	CYJian 已经算出来这个式子的值了. 现在请你帮他验算一下吧. CYJian 只给你 0.2s 的时间哦

	\textbf{输入格式}

	一行一个正整数 \(N\)

	\textbf{输出格式}

	一行一个正整数，表示答案模 \(104857601\) 的值

	\textbf{样例输入}

	\includecode[common]{lgp5221.in}

	\textbf{样例输出}

	\includecode[common]{lgp5221.ans}

	\textbf{说明}

	样例解释:

	\begin{tabular}{cccccc}
		\hline
		lcm/gcd    & 1 & 2  & 3  & 4  & 5  \\
		\hline
		\textbf{1} & 1 & 2  & 3  & 4  & 5  \\
		\textbf{2} & 2 & 1  & 6  & 2  & 10 \\
		\textbf{3} & 3 & 6  & 1  & 12 & 15 \\
		\textbf{4} & 4 & 2  & 12 & 1  & 20 \\
		\textbf{5} & 5 & 10 & 15 & 20 & 1  \\
		\hline
	\end{tabular}

	对于 \(30\%\) 的数据: \(1 \leq N \leq 5000\)

	对于 \(100\%\) 的数据: \(1 \leq N \leq 1\ 000\ 000\)
\end{frame}


\begin{frame}{题解}
	\only<1->{推式子

		\[
			\begin{aligned}
				\prod_{i=1}^n\prod_{j=1}^n \frac{ij}{(i,j)^2} & =\frac{(n!)^{2n}}{\prod_{i=1}^n\prod_{j=1}^n(i,j)^2}                                                                       \\
				                                              & =\frac{(n!)^{2n}}{\prod_{d=1}^nd^{2\sum_{i=1}^{\lfloor\frac{n}{d}\rfloor}\sum_{j=1}^{\lfloor\frac{n}{d}\rfloor}[(i,j)=1]}} \\
				                                              & =\frac{(n!)^{2n}}{\prod_{d=1}^nd^{2\sum_{e=1}^{\lfloor\frac{n}{d}\rfloor}\mu(e)\lfloor\frac{n}{de}\rfloor^2}}              \\
			\end{aligned}
		\]}

	\only<2->{两层整除分块即可}

	\only<3->{\textbf{时间复杂度} \(O(n)\)}
\end{frame}


\begin{frame}[fragile,allowframebreaks]{实现}
	\includecode[c++]{lgp5221.cpp}
\end{frame}
